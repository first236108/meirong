{include file="public/header" /}
{include file="public/breadcrumb" /}
<link href="/static/plugins/footable/footable.core.css" rel="stylesheet">
<link href="/static/plugins/datapicker/datepicker3.css" rel="stylesheet">
<div class="wrapper wrapper-content animated fadeInRight ecommerce">

    <div class="ibox-content m-b-sm border-bottom p-m-10">
        <div class="row" id="search-bar">
            <form id="top-search">
                <div class="col-sm-2">
                    <div class="form-group">
                        <label class="control-label" for="is_valid">会员状态</label>
                        <select name="is_valid" id="is_valid" class="form-control">
                            <option value="1" selected>正常</option>
                            <option value="0">黑名单</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="form-group">
                        <label for="create_time">注册时间</label>
                        <div class="input-group date">
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            <input type="text" id="create_time" name="create_time" class="form-control">
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="form-group">
                        <label for="last_come">到店时间</label>
                        <div class="input-group date">
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            <input type="text" id="last_come" name="last_come" class="form-control">
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="form-group">
                        <label class="control-label" for="nameorphone">搜索词</label>
                        <input type="text" id="nameorphone" name="nameorphone" value="" placeholder="手机号/名字" class="form-control">
                    </div>
                </div>
                <div class="col-sm-1">
                    <div class="form-group">
                        <label>&nbsp;</label>
                        <button type="submit" class="btn btn-primary btn-block">Go</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12">
            <div class="ibox">
                <div class="ibox-content">

                    <table class="footable table table-stripped toggle-arrow-tiny" data-page-size="15">
                        <thead>
                        <tr>
                            <th data-toggle="true" class="first-td">Product Name</th>
                            <th data-hide="phone">Model</th>
                            <th data-hide="phone">Price</th>
                            <th data-hide="phone,tablet">Quantity</th>
                            <th data-hide="phone">Status</th>
                            <th class="text-right" data-sort-ignore="true">Action</th>

                        </tr>
                        </thead>
                        <tbody>
                            <tr v-for="(user,index) in list">
                            <td class="first-td">
                                {{user.id}}
                            </td>
                            <td>
                                {{user.name}}
                            </td>
                            <td>
                                {{user.phone}}
                            </td>
                            <td>
                                {{user.last_come}}
                            </td>
                            <td>
                                <span class="label label-primary">Enable</span>
                            </td>
                            <td class="text-right">
                                <div class="btn-group">
                                    <button class="btn-white btn btn-xs">View</button>
                                    <button class="btn-white btn btn-xs">Edit</button>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                        <tfoot>
                        <tr>
                            <td colspan="6">
                                <ul class="pagination pull-right"></ul>
                            </td>
                        </tr>
                        </tfoot>
                    </table>

                </div>
            </div>
        </div>
    </div>

</div>

<script src="/static/js/vue.min.js"></script>
<script src="/static/plugins/footable/footable.all.min.js"></script>
<script src="/static/plugins/datapicker/bootstrap-datepicker.js"></script>
<script src="/static/plugins/layer/mobile/layer.js"></script>
<script>
    $(document).ready(function () {

        $('.footable').footable();

        $('#search-bar .input-group.date').datepicker({
            todayBtn: "linked",
            keyboardNavigation: false,
            forceParse: false,
            calendarWeeks: true,
            autoclose: true
        });

        $("#top-search").validate({
            rules: {
                create_time: {
                    date: true
                },
                last_time: {
                    date: true
                },
                nameorphone: {
                    minlength: 1
                }
            },
            messages: {
                create_time: "注册时间 错误",
                last_time: "到店时间 错误",
                nameorphone: "手机号/名字 长度错误"
            },
            submitHandler: function (form) {
                $.ajax({
                    type: 'POST',
                    url: '/admin/member/index',
                    data: $(form).serialize(),
                    success: function (data) {
                        layer.open({
                            content: '数据已更新',
                            skin: 'msg',
                            time: 1
                        });
                        vm.list = data;
                    },
                    error: function (xhr,er) {
                        err();
                    }
                });
            }
        });
    });

    var vm = new Vue({
        el: '#wrapper',
        data: {
            list: []
        },
        created: function () {
            init();
        }
    });

    function init() {
        $.ajax({
            type: 'POST',
            url: '/admin/member/index',
            success: function (data) {
                vm.list = data;
            },
            error: function (xhr, type) {
                err();
            }
        });
    }
</script>
{include file="public/footer" /}